{
  "hash": "ce2f2c1f5ccd92fd469d51831a48f077",
  "result": {
    "markdown": "---\ntitle: \"UK Elections 2019\"\ndate: \"2019-12-13\"\ncategories: [political science, dataViz]\nexecute: \n  eval: false\n---\n\n\nAfter the UK elections in 2017, I posted about how [easy it was to plot the results in R](https://www.robertmylesmcdonnell.com/content/posts/uk-elections-2017/). Given that the UK just had another election, I thought Iâ€™d update that post with another one. So here ya go.\n\nWhat we'll do is make a plot of the results using R, and then we'll compare it to the last election using static plots and a GIF. You'll need to install the relevant packages below if you plan to try this out yourself.\n\nThe data for the results is hosted on my github, here we'll just read it in from there. The only other work pre-plotting is joining the results and the geographic data and combining some smaller parties into an \"Other\" category, which is not really necessary, but leaves the plot cleaner. Actually, most of the work is choosing the colours!!\n\n\n::: {.cell hash='UKElections2019_cache/html/unnamed-chunk-1_ecd8d68256c244b6304b87334d80ae86'}\n\n```{.r .cell-code}\nxfun::pkg_attach(c(\"jsonlite\", \"dplyr\", \"rnaturalearthhires\", \"sf\", \"parlitools\", \"ggplot2\", \"patchwork\", \"magick\"))\n\nres_file <- \"https://raw.githubusercontent.com/RobertMyles/blogdata/master/results.json\"\nuk <- west_hex_map %>%\n  select(ons = gss_code, geometry)\n\nresults <- fromJSON(res_file) %>%\n  as_tibble() %>%\n  full_join(uk) %>%\n  select(-candidates) %>%\n  st_as_sf() %>%\n  mutate(\n    party = case_when(\n      winningParty %in% c(\"Speaker\", \"Green\", \"Alliance\", \"PC\", \"SDLP\") ~ \"Other\",\n      TRUE ~ winningParty\n    )\n  ) %>%\n  filter(!is.na(party))\n\nggplot(results) +\n  geom_sf(aes(fill = party), size = 0.2) +\n  theme_minimal() +\n  theme(axis.text = element_blank(),\n        panel.grid = element_blank(),\n        plot.title.position = \"plot\") +\n  guides(fill = guide_legend(title = \"Party\")) +\n  scale_fill_manual(values = c(\"#0084c6\", \"#880105\", \"#c70000\",\n                                \"#ee6f00\", \"#888888\", \"#236925\",\n                                \"#ffe500\")) +\n  ggtitle(\"UK Elections 2019\")\n```\n:::\n\n\n![](images/uk2019.png)\n\nOverwhelming rejection of Corbyn there.\n\nWith patchwork (recently CRANified, yay), we can compare 2017's winners with the winners this year:\n\n\n::: {.cell hash='UKElections2019_cache/html/unnamed-chunk-2_0fa180bc996434f17d987a63396b27a5'}\n\n```{.r .cell-code}\nfirst <- ggplot(results) +\n  geom_sf(aes(fill = sittingParty), size = 0.2) +\n  theme_minimal() +\n  theme(axis.text = element_blank(),\n        panel.grid = element_blank(),\n        plot.caption = element_text(hjust = 0.5)) +\n  guides(fill = guide_legend(title = \"Party\")) +\n  scale_fill_manual(values = c(\"#92B4F4\", \"#0084c6\", \"#880105\",  \"forestgreen\",\n                               \"grey88\", \"#c70000\", \"darkorange\", \"#BDF7B7\",\n                              \"#749C75\", \"#ffe500\", \"#CEBACF\")) +\n  labs(caption = \"UK Elections 2017\")\n\nsecond <- ggplot(results) +\n  geom_sf(aes(fill = winningParty), size = 0.2) +\n  theme_minimal() +\n  theme(axis.text = element_blank(),\n        panel.grid = element_blank(),\n        plot.caption = element_text(hjust = 0.5)) +\n  guides(fill = guide_legend(title = \"Party\")) +\n  scale_fill_manual(values = c(\"#92B4F4\", \"#0084c6\", \"#880105\",  \"forestgreen\",\n                               \"#c70000\", \"darkorange\", \"#BDF7B7\",\n                               \"#CEBACF\",  \"#749C75\", \"#ffe500\", \"grey88\")) +\n  labs(caption = \"UK Elections 2019\")\n\nfirst + second + plot_annotation(title =  \"Comparison of Results, UK elections 2017 & 2019\")\n```\n:::\n\n\n![](images/uk2019_2.png)\n\nWe can really see the change in the so-called ['Red Wall'](https://www.theguardian.com/politics/2019/dec/13/bombastic-boris-johnson-wins-huge-majority-on-promise-to-get-brexit-done) that has given the Conservatives such a huge victory. Let's animate this change, because we can, y'allz. All we need to do is save the bare images and use the magick library to animate the images as a gif. The code is the following, but obviously you'll need to use your own paths and images.\n\n\n::: {.cell hash='UKElections2019_cache/html/unnamed-chunk-3_f26e512e9bb056d05fa36f1c6c3439a7'}\n\n```{.r .cell-code}\nimg1 <- image_read(\"images/img2019.png\")\nimg2 <- image_read(\"images/img2017.png\")\nframes <- image_morph(c(img1, img2, img1), frames = 25)\nimage_animate(frames, fps = 10)\n```\n:::\n\n\n![](https://github.com/RobertMyles/blogdata/raw/master/uk.gif)\n\nUntil next UK election...\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}