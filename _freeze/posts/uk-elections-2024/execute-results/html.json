{
  "hash": "8180d789891b1c8275adeb68157af7f2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Uk Elections 2024\"\ndate: \"2024-07-05\"\ncategories: [political science]\nexecute: \n  eval: true\n---\n\n\n\nWell I [did say](https://www.robertmylesmcdonnell.com/posts/ukelections2019) I'd do another one of these come the next UK election, so here goes. The official data won't be published until Friday the 12th of July but we can use our creativity to get it before then. Ok, I did so you don't have to and you can get the results [here](https://raw.githubusercontent.com/RobertMyles/blogdata/master/uk_elections_2024.json). \n\nI'd ideally like to make use of [parlitools']() `west_hex_map`, as I did previously, but unfortunately that package is out of date with respect to the electoral areas of the UK. After a bit of searching, I did find a new hex map for this purpose [here](https://automaticknowledge.org/wpc-hex/) -- thank you [Alasdair Rae & co.](http://www.statsmapsnpix.com/2023/07/a-new-uk-constituency-hex-map.html) Alasdair also explains why you might want to use these hex maps instead of a regular geographically-accurate map in this blogpost (equal population areas). \n\nI'll combine this hex with the election results linked to above through the [GSS Code](https://en.wikipedia.org/wiki/GSS_coding_system). You can get this data from [here](https://automaticknowledge.org/wpc-hex/uk-wpc-hex-constitcode-v5-june-2024.geojson).\n\n\nFirst, we'll load the libraries I'm going to use and get the data we need. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(sf)\nlibrary(dplyr)\nlibrary(purrr)\nlibrary(jsonlite)\n\nresults_data <- \"https://raw.githubusercontent.com/RobertMyles/blogdata/master/uk_elections_2024.json\"\nhexes <- st_read(\"https://automaticknowledge.org/wpc-hex/uk-wpc-hex-constitcode-v5-june-2024.geojson\", quiet = TRUE)\n```\n:::\n\n\n\n\nThe results are in a list, so I will use `pluck()` from the purrr package to take out the actual results (`constit_summary` ) and the full party name (`sop` > `parties`). I'm going to rename some columns here to make joining easier later on.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nparties <- fromJSON(results_data) |> \n  pluck(\"sop\", \"parties\") |> \n  select(party = name, party_abb = abbreviation)\n\nresults <- fromJSON(results_data) %>%\n  pluck(\"constit_summary\") |> \n  rename(party_abb = winner_abbreviation) |> \n  left_join(parties) |> \n  mutate(\n    party = case_when(\n      party_abb == \"TUV\" ~ \"The Unionist Voice\",\n      party_abb == \"Ind\" ~ \"Independent\",\n      party_abb == \"Speaker\" ~ \"Speaker\",\n      TRUE ~ party\n    )\n  )\n\nhexes <- hexes |> rename(pcon24 = GSScode)\n```\n:::\n\n\n\nOk, so now we can have a quick look at the results (Labour smashed the Conservative party, in case you didn't know). \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresults |> \n  group_by(party) |> \n  count(sort = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 15 Ã— 2\n# Groups:   party [15]\n   party                                  n\n   <chr>                              <int>\n 1 Labour                               411\n 2 Conservative                         121\n 3 Liberal Democrat                      71\n 4 Scottish National Party                9\n 5 Sinn Fein                              7\n 6 Independent                            6\n 7 Democratic Unionist Party              5\n 8 Green                                  4\n 9 Plaid Cymru                            4\n10 Reform UK                              4\n11 Social Democratic and Labour Party     2\n12 Alliance                               1\n13 Speaker                                1\n14 The Unionist Voice                     1\n15 Ulster Unionist Party                  1\n```\n\n\n:::\n:::\n\n\n\nSo we've got a few small parties here, and the Speaker. Let's group them into an \"Other\" category. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresults <- results |> \n  mutate(\n    party = case_when(\n      party_abb %in% c(\"Alliance\", \"Speaker\", \"UUP\", \"SDLP\", \"TUV\") ~ \"Other\",\n      TRUE ~ party\n      )\n    )\n```\n:::\n\n\n\nOur election data looks pretty good now so we can join it with the hex map data. There are two constituencies that haven't declared at the time of writing so we'll remove those. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmap <- hexes |> left_join(results, by = \"pcon24\")\n\nmap <- map |> \n  filter(!is.na(party)) %>%\n  st_as_sf()\n```\n:::\n\n\n\n\nLet's plot 'er up! (Colour scheme from [here](https://www.thetimes.com/article/general-election-live-results-in-full-uk-2024-tprzgvflr?v=true))\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(map) +\n  geom_sf(aes(fill = party), size = 0.2) +\n  theme_void() +\n  guides(fill = guide_legend(title = \"Party\", position = \"left\")) +\n  scale_fill_manual(values = c(\n     \"#5691AF\", \"#975654\", \"#72A768\", \"#98B3D1\", \n     \"#DA5C5B\", \"#E0AD3B\", \"#888888\", \"#9DCB84\",\n     \"#54B3CC\", \"#F1D848\", \"#5A9464\"\n     )\n    )\n```\n\n::: {.cell-output-display}\n![](uk-elections-2024_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n**_Very_** different to last time! \n\n",
    "supporting": [
      "uk-elections-2024_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}